<!doctype html>
<html lang="zh-Hant">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>送上祝福</title>

<!-- ✅ 我可以調：字體（標題/內文） -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<!-- Sacramento（標題）＋ Patrick Hand（內文/工具列/狀態列） -->
<link href="https://fonts.googleapis.com/css2?family=Patrick+Hand:wght@400&family=Sacramento:wght@400;700&display=swap" rel="stylesheet">

<style>
/* ====================== 全域變數（我可以調：配色/尺寸/陰影/圖片） ====================== */
:root{
  /* —— 主題顏色 —— */
  --brand-bg: #c9daf8;          /* ✅ 整頁底色（藍） */
  --paper:    #fff2cc;          /* ✅ 內文/面板底色（黃）→ 與卡片統一，避免雙色 */
  --title:    #A68A7C;          /* ✅ 標題字色（沿用互動音符主題） */
  --ink:      #0f172a;          /* ✅ 一般文字色 */
  --accent:   #A68A7C;          /* ✅ 重點/飾色（和互動音符一致） */
  --rim:      #E4E4E4;          /* ✅ 邊框基色 */
  --soft:     #F5F1EC;          /* ✅ 狀態列/提示底色（與互動音符一致；樣式鎖定） */

  /* —— 背景圖片（放在 /assets/wishing.png）—— */
  --bg-image-url: url("./assets/wishing.png");

  /* —— 漸層（標題列）—— */
  --titlebar-grad-from: #b7d2f6; /* ✅ 標題列漸層色(左/上) */
  --titlebar-grad-to:   #cfe1fb; /* ✅ 標題列漸層色(右/下) */

  /* —— 版寬與圓角/陰影 —— */
  --panel-maxw: 1020px;         /* ✅ 主要面板最大寬 */
  --radius-xl:  16px;           /* ✅ 大圓角 */
  --radius-md:  12px;           /* ✅ 一般圓角 */
  --shadow-1:   0 10px 26px rgba(0,0,0,.10);  /* ✅ 面板陰影 */
  --shadow-2:   0 2px 0 rgba(0,0,0,.15), 0 2px 8px rgba(0,0,0,.06); /* ✅ 按鈕陰影 */

  /* —— 內文排版 —— */
  --content-pad: 22px;          /* ✅ 內文 padding */
  --content-gap: 14px;          /* ✅ 內文區塊上下間距 */
  --content-line: 2px;          /* ✅ 內文虛線粗細 */
  --content-line-alpha: .10;    /* ✅ 內文虛線透明度（更淡化） */
  --editor-zoom: 1rem;          /* ✅ 未選字放大/縮小的全域字級（動態調整） */

  /* —— 工具列/狀態列 —— */
  --toolbar-gap: 8px;           /* ✅ 工具列按鈕間距 */
  --status-fz: 14px;            /* ✅ 狀態列字級（與互動音符一致=14px） */

  /* —— 標題尺寸（與互動音符一致）—— */
  --h2-size: 2.8rem;            /* ✅ 標題字級 */

  /* —— 全站描邊/高光（與互動音符同質感）—— */
  --stroke: rgba(0,0,0,.18);    /* ✅ 文字描邊 */
  --glow:   rgba(255,255,255,.65); /* ✅ 文字高光 */
}

/* ====================== 全站與背景 ====================== */
*{ box-sizing:border-box; }
html,body{
  margin:0; color:var(--ink);
  background: var(--brand-bg);
  font-family: "Patrick Hand","Noto Sans TC",system-ui,-apple-system,sans-serif;
  -webkit-text-stroke:.35px var(--stroke);
  text-shadow:0 1px 0 var(--glow);
}
body::before{
  /* ✅ 背景圖 + 柔化/混合（只掛在 body，不影響簽名縮圖） */
  content:""; position:fixed; inset:0; z-index:-1;
  background-image: var(--bg-image-url);
  background-size:cover; background-position:center;
  opacity:.35; mix-blend-mode:multiply; filter:contrast(1.05) saturate(1.05);
}

/* ====================== 面板 & 標題列 ====================== */
.panel{
  max-width: var(--panel-maxw);
  margin: 22px auto;
  background: var(--paper);                     /* ✅ 與卡片統一，避免雙色錯覺 */
  border:1px solid var(--rim);
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow-1);
  overflow:hidden;                              /* 讓 titlebar 圓角貼齊 */
}

/* —— 標題列（藍色漸層；高度略窄） —— */
.titlebar{
  background: linear-gradient(135deg, var(--titlebar-grad-from), var(--titlebar-grad-to));
  padding: 8px 16px;                           /* ✅ 比原本更窄 */
  position: relative;
}

/* —— 標題（字色回原主題色；置中；與互動音符同級） —— */
h2{
  margin: 2px 0 6px;
  text-align:center;
  font-family: "Sacramento", cursive;
  font-weight: 700;
  font-size: var(--h2-size);   /* ✅ 與互動音符一致：2.8rem */
  letter-spacing: 1px;
  color: var(--title);
  -webkit-text-stroke:.6px rgba(0,0,0,.12);
  text-shadow:0 3px 4px rgba(255,255,255,.75);
}

/* —— 標題列下方：工具列（左） + 狀態列（右） —— */
.bar{
  display:flex; align-items:center; justify-content:space-between;
  gap: 10px;
  padding: 8px 16px 12px;
  background: transparent;
}

/* —— 工具列靠左 —— */
.toolbar{
  display:flex; gap: var(--toolbar-gap);
  margin: 0; /* 左側對齊 */
  filter: drop-shadow(0 2px 0 rgba(0,0,0,.08));
}
.tool-btn, .tool-select{
  min-width: 64px; height: 36px; padding: 0 12px;
  background:#fff; border:1px solid var(--rim); border-radius: var(--radius-md);
  font-weight:700; cursor:pointer;
  -webkit-text-stroke:.25px rgba(0,0,0,.12); text-shadow:0 1px 0 rgba(255,255,255,.5);
  box-shadow: var(--shadow-2);
  display:flex; align-items:center; justify-content:center; gap:6px;
}
.tool-btn:active{ transform:translateY(1px) scale(.99); }
.tool-select{
  min-width: auto; padding: 0 10px; cursor:default;
}

/* —— 狀態列（與互動音符一致；放右側） —— */
#status{
  background: var(--soft); border:1px solid #E4E4E4; border-radius:12px;
  padding:10px; font-size: var(--status-fz); white-space:pre-wrap; text-align:center;
  color: var(--accent) !important; font-weight:700;
  -webkit-text-stroke:.35px rgba(0,0,0,.10);
  text-shadow:0 1px 0 rgba(255,255,255,.85), 0 3px 6px rgba(0,0,0,.04);
  min-width: 220px;
}
#status.ok,#status.busy,#status.err{ color: var(--accent) !important; }

/* ====================== 內容容器 ====================== */
.stage{ position:relative; padding: 22px 22px 10px; }

/* —— 內文卡（黃底；去漸層，與面板同系） —— */
.card{
  position:relative;
  margin: 18px auto;
  background: var(--paper);                     /* ✅ 統一顏色 */
  border:1px solid rgba(0,0,0,.05);
  border-radius: var(--radius-xl);
  box-shadow: 0 10px 26px rgba(0,0,0,.08);
  max-width: 900px;
  padding: var(--content-pad);
}

/* —— 內文可編輯區（contenteditable） —— */
.editor{
  min-height: 320px;
  line-height: 1.8;
  outline: none;
  background: transparent;
  border-radius: var(--radius-md);
  padding: 10px 12px;
  font-size: var(--editor-zoom);                /* ✅ 未選字時的整體縮放 */
  background-image:
    linear-gradient(to bottom, rgba(0,0,0,var(--content-line-alpha)) var(--content-line), transparent 0);
  background-size: 100% 38px;
}

/* —— 文字強調（放大/縮小的 class，支援連點逐級） —— */
.fs-up-1 { font-size: 1.15em; }
.fs-up-2 { font-size: 1.30em; }
.fs-up-3 { font-size: 1.50em; }
.fs-down-1 { font-size: .92em; }
.fs-down-2 { font-size: .84em; }
.fs-down-3 { font-size: .76em; }

/* —— 左上/右下的小框（新人 / 簽名） —— */
/* 尺寸統一：兩者同 padding/字級/圓角，差別只在外框顏色 */
.badge{
  position:absolute;
  background: var(--paper);
  color: var(--ink);
  padding: 10px 14px;                            /* ✅ 放大 */
  border-radius: 10px;
  box-shadow: 0 2px 8px rgba(0,0,0,.06);
  font-weight:700;
  display:flex; align-items:center; gap:8px;
}
.badge-top-left{ left: -8px; top: -12px; border: none; }                 /* ✅ 新人無外框 */
.badge-bottom-right{ right: -8px; bottom: -12px; border: 1px solid rgba(0,0,0,.08); cursor:pointer; }
.badge-bottom-right img{
  width: 64px; height: 36px; object-fit:contain;
  background:#fff; border-radius:6px; border:1px dashed rgba(0,0,0,.08);
}
.badge-bottom-right .hint{ opacity:.6; }         /* ✅ 「點我簽名」淡化 */

/* —— 送出按鈕（移到卡片外，下方置中） —— */
.actions{
  display:flex; align-items:center; justify-content:center;
  margin: 14px auto 18px;
}
.primary{
  min-width: 180px; height: 42px; padding: 0 18px;
  background:#fff; border:1px solid var(--rim); border-radius: var(--radius-md);
  font-weight:700; cursor:pointer; box-shadow: var(--shadow-2);
}
.primary:active{ transform:translateY(1px) scale(.99); }

/* ====================== 簽名 Modal ====================== */
.overlay{ position:fixed; inset:0; z-index:9999; display:none; align-items:center; justify-content:center; background:rgba(17,24,39,.35); backdrop-filter:blur(3px); }
.overlay.show{ display:flex; }
.dialog{
  width:min(92vw, 520px);
  background: var(--soft);
  border:1px solid var(--rim);
  border-radius: 14px;
  padding: 16px;
  box-shadow: 0 18px 44px rgba(0,0,0,.18);
}
.dialog h3{ margin: 0 0 10px; font-size:18px; color:#6b5e52; text-align:center; -webkit-text-stroke:0; text-shadow:none; }
#pad{
  width:100%; height:260px;
  background:#fff; border:1px solid #ddd; border-radius:12px;
  touch-action:none;
}
.dlg-actions{ display:flex; gap:10px; justify-content:center; margin-top:12px; }
.dlg-actions button{ width:120px; height:38px; border-radius:10px; border:1px solid var(--rim); background:#fff; cursor:pointer; font-weight:700; }

/* ====================== Footer ====================== */
footer{ max-width: var(--panel-maxw); margin: 8px auto 22px; text-align:center; color:#6b5e52; font-size:12px; opacity:.9; }
</style>

<body>
  <div class="panel">
    <!-- 標題列（藍色漸層） -->
    <div class="titlebar">
      <h2>送上祝福</h2>
      <div class="bar">
        <!-- 工具列（靠左） -->
        <div class="toolbar" role="toolbar" aria-label="文字工具">
          <button class="tool-btn" id="btnBold"      type="button" title="粗體">粗體</button>
          <button class="tool-btn" id="btnItalic"    type="button" title="斜體">斜體</button>
          <button class="tool-btn" id="btnUnderline" type="button" title="底線">底線</button>
          <!-- 簡易字色選單 -->
          <select id="colorPick" class="tool-select" title="字體顏色">
            <option value="" selected>顏色</option>
            <option value="#0f172a">墨色</option>
            <option value="#a21caf">紫</option>
            <option value="#dc2626">紅</option>
            <option value="#2563eb">藍</option>
            <option value="#059669">綠</option>
            <option value="#d97706">橘</option>
            <option value="#6b7280">灰</option>
          </select>
          <button class="tool-btn" id="btnBigger"    type="button" title="放大">放大</button>
          <button class="tool-btn" id="btnSmaller"   type="button" title="縮小">縮小</button>
        </div>
        <!-- 狀態列（放右側；樣式與互動音符一致） -->
        <p id="status">尚未初始化</p>
      </div>
    </div>

    <!-- 內容舞台 -->
    <div class="stage">
      <!-- 內文卡 -->
      <div class="card" id="card">
        <!-- 左上：新人（由後端帶入；預設佔位） -->
        <div class="badge badge-top-left" id="chipBride"><span id="brideLabel">新人：—</span></div>
        <!-- 右下：簽名（可點開放大簽） -->
        <div class="badge badge-bottom-right" id="chipSign">
          <span class="hint">點我簽名</span>
          <img id="signThumb" alt="signature preview" />
        </div>

        <!-- 內文（contenteditable） -->
        <div id="editor" class="editor" contenteditable="true" aria-label="祝福內容">
          在此寫下你對新人的祝福…（可選字後按上方的粗體／斜體／底線／顏色／放大／縮小）💝
        </div>
      </div>
    </div>
  </div>

  <!-- 送出鍵（移到卡片外，下方置中） -->
  <div class="actions">
    <button id="btnSubmit" class="primary" type="button">送出祝福</button>
  </div>

  <footer>© Copyright 2025 MY‘s System</footer>

  <!-- ====================== 簽名 Modal ====================== -->
  <div id="sigOverlay" class="overlay" role="dialog" aria-modal="true" aria-labelledby="sigTitle">
    <div class="dialog">
      <h3 id="sigTitle">請於下方簽名</h3>
      <canvas id="pad"></canvas>
      <div class="dlg-actions">
        <button id="sigClear"  type="button">清除</button>
        <button id="sigCancel" type="button">取消</button>
        <button id="sigOK"     type="button">確定</button>
      </div>
    </div>
  </div>

<script>
/* ====================== 前端設定（我可以調：LIFF/GAS/逾時） ====================== */
const LIFF_ID = '2008149060-m5pDXW6a'; // ✅ 你的 LIFF ID
const WEBHOOK = 'https://meiyang0819.github.io/SSS/blessing.html'; // ✅ 你的 GAS 入口（已支援 createBlessing）
const TIMEOUT_MS = 20000; // ✅ 請求逾時

/* ====================== 工具：狀態列（沿用互動音符的語氣） ====================== */
function setStatus(m){
  const el = document.getElementById('status');
  el.textContent = m;
  el.classList.remove('ok','busy','err');
  if(/成功|已載入|就緒/.test(m)) el.classList.add('ok');
  else if(/送出中|等待|處理/.test(m)) el.classList.add('busy');
  else if(/失敗|逾時|無法|錯誤/.test(m)) el.classList.add('err');
}

/* ====================== LIFF 初始化（自動帶入 lineId / 新人名） ====================== */
let lineId='', displayName='', pictureUrl='';
async function initLIFF(){
  if(typeof liff === 'undefined'){ setStatus('（未載入 LIFF SDK，可先測樣式）'); return; }
  try{
    setStatus('初始化 LIFF…');
    await liff.init({ liffId: LIFF_ID, withLoginOnExternalBrowser:true });
    if(!liff.isLoggedIn()){ liff.login({ scope:['openid','profile'] }); return; }
    if(liff.ready) await liff.ready;

    let prof=null, idt=null;
    try{ prof=await liff.getProfile(); }catch(_){}
    try{ idt=liff.getDecodedIDToken(); }catch(_){}

    lineId      = (prof&&prof.userId) || (idt&&idt.sub) || '';
    displayName = (prof&&prof.displayName) || (idt&&(idt.name||idt.nickname)) || '';
    pictureUrl  = (prof&&prof.pictureUrl) || '';

    // 左上角「新人」：向後端詢問（若後端尚未實作，會保留預設 —）
    if(lineId){
      try{
        const r = await fetch(WEBHOOK+'?action=couple&lineId='+encodeURIComponent(lineId),{method:'GET',cache:'no-store'});
        if(r.ok){
          const j = await r.json().catch(()=>null);
          if(j && j.ok && j.name){
            document.getElementById('brideLabel').textContent = '新人：' + String(j.name||'—');
          }
        }
      }catch(_){}
    }

    setStatus('已就緒');
  }catch(e){
    setStatus('LIFF 初始化失敗：'+ e.message);
  }
}

/* ====================== 編輯器工具列（粗體／斜體／底線／顏色／放大／縮小） ====================== */
// 粗體/斜體/底線、字色使用 execCommand（跨瀏覽器最單純）；
// 放大/縮小：有選取時只包選取；未選取時調整整個 editor 的 --editor-zoom。
const editor = document.getElementById('editor');

function btnExec(cmd){
  document.execCommand(cmd, false, null);
  editor.focus();
}
document.getElementById('btnBold').addEventListener('click',   ()=>btnExec('bold'));
document.getElementById('btnItalic').addEventListener('click', ()=>btnExec('italic'));
document.getElementById('btnUnderline').addEventListener('click',()=>btnExec('underline'));

const colorPick = document.getElementById('colorPick');
colorPick.addEventListener('change', ()=>{
  const val = colorPick.value;
  if(val){
    document.execCommand('foreColor', false, val);
    editor.focus();
  }
  colorPick.blur();
});

/* —— 放大/縮小 —— */
function wrapSelectionWithClass(cls){
  const sel = window.getSelection();
  if(!sel.rangeCount) return false;
  const range = sel.getRangeAt(0);
  if(range.collapsed) return false; // 沒選字 → 交由全域縮放
  const span = document.createElement('span');
  span.className = cls;
  try{
    range.surroundContents(span);
  }catch(_){
    // 若選取跨多節點，改用簡單方式：用 <span> 包住 range 內容的 clone
    const frag = range.extractContents();
    span.appendChild(frag);
    range.insertNode(span);
  }
  // 光標移到包完的後面
  const sel2 = window.getSelection();
  sel2.removeAllRanges();
  const newRange = document.createRange();
  newRange.setStartAfter(span);
  newRange.collapse(true);
  sel2.addRange(newRange);
  editor.focus();
  return true;
}

// 全域縮放（未選字）
let globalScale = 1;  // 以 1rem 為基準
function setGlobalScale(sc){
  globalScale = Math.max(0.7, Math.min(1.7, sc)); // 夾在 0.7x~1.7x
  editor.style.setProperty('--editor-zoom', globalScale + 'rem');
}
function stepBigger(){
  // 先嘗試包選取；若沒有選取 → 全域放大
  if(!wrapSelectionWithClass('fs-up-1')){
    setGlobalScale(globalScale + 0.06);
  }
}
function stepSmaller(){
  if(!wrapSelectionWithClass('fs-down-1')){
    setGlobalScale(globalScale - 0.06);
  }
}
document.getElementById('btnBigger').addEventListener('click', stepBigger);
document.getElementById('btnSmaller').addEventListener('click', stepSmaller);

/* —— 重新選其他文字，清空選取級數（避免無限疊加） —— */
['mouseup','keyup'].forEach(evt=>{
  editor.addEventListener(evt, ()=>{ /* 保留全域縮放，不重置 */ });
});

/* ====================== 內文 placeholder 行為 ====================== */
const PLACEHOLDER = '在此寫下你對新人的祝福…（可選字後按上方的粗體／斜體／底線／顏色／放大／縮小）💝';
function isOnlyPlaceholder(){
  return editor.innerText.trim()===PLACEHOLDER.replace(/\u200B/g,'').trim()
      || editor.innerHTML.trim()===editorPlaceholderHTML;
}
// 用一個帶淡色的 placeholder 樣式（避免送出時誤判為使用者輸入）
const editorPlaceholderHTML = PLACEHOLDER;

function showPlaceholder(){
  editor.setAttribute('data-empty','');
  editor.innerHTML = editorPlaceholderHTML;
  editor.style.opacity = .75;
}
function clearPlaceholderIfNeeded(){
  if(editor.hasAttribute('data-empty')){
    editor.innerHTML = '';
    editor.removeAttribute('data-empty');
    editor.style.opacity = 1;
  }
}
editor.addEventListener('focus', clearPlaceholderIfNeeded);
editor.addEventListener('input', clearPlaceholderIfNeeded);
editor.addEventListener('blur', ()=>{
  const txt = editor.innerText.replace(/\s+/g,'').trim();
  if(!txt){ showPlaceholder(); }
});

/* ====================== 簽名（點小框 → Modal 畫簽） ====================== */
const sigOverlay = document.getElementById('sigOverlay');
const pad = document.getElementById('pad');
const ctx = pad.getContext('2d');
let drawing=false, lastX=0, lastY=0, signatureDataURL='';

function fitCanvas(){
  const dpr = Math.max(1, window.devicePixelRatio || 1);
  const cssW = pad.clientWidth, cssH = pad.clientHeight;
  pad.width = Math.floor(cssW * dpr);
  pad.height = Math.floor(cssH * dpr);
  ctx.setTransform(dpr,0,0,dpr,0,0);
  ctx.lineCap='round'; ctx.lineJoin='round';
  ctx.lineWidth=3;
  ctx.strokeStyle='#111';
  ctx.clearRect(0,0,cssW,cssH);
}

function openSign(){ sigOverlay.classList.add('show'); setTimeout(fitCanvas, 40); }
function closeSign(){ sigOverlay.classList.remove('show'); }

function pointerPos(e){
  const rect = pad.getBoundingClientRect();
  const x = (e.touches? e.touches[0].clientX : e.clientX) - rect.left;
  const y = (e.touches? e.touches[0].clientY : e.clientY) - rect.top;
  return {x,y};
}
function startDraw(e){ drawing=true; const p=pointerPos(e); lastX=p.x; lastY=p.y; e.preventDefault(); }
function moveDraw(e){
  if(!drawing) return;
  const p=pointerPos(e);
  ctx.beginPath(); ctx.moveTo(lastX,lastY); ctx.lineTo(p.x,p.y); ctx.stroke();
  lastX=p.x; lastY=p.y;
  e.preventDefault();
}
function endDraw(){ drawing=false; }
pad.addEventListener('mousedown', startDraw);
pad.addEventListener('mousemove', moveDraw);
pad.addEventListener('mouseup', endDraw);
pad.addEventListener('mouseleave', endDraw);
pad.addEventListener('touchstart', startDraw, {passive:false});
pad.addEventListener('touchmove', moveDraw, {passive:false});
pad.addEventListener('touchend', endDraw);

document.getElementById('chipSign').addEventListener('click', openSign);
document.getElementById('sigClear').addEventListener('click', fitCanvas);
document.getElementById('sigCancel').addEventListener('click', closeSign);
document.getElementById('sigOK').addEventListener('click', ()=>{
  signatureDataURL = pad.toDataURL('image/png');
  const img = document.getElementById('signThumb');
  img.src = signatureDataURL;
  closeSign();
});

/* ====================== 送出祝福 ====================== */
document.getElementById('btnSubmit').addEventListener('click', async ()=>{
  // 清掉 placeholder
  if(editor.hasAttribute('data-empty')){ alert('請寫下祝福內容唷～'); return; }

  const text = editor.innerHTML.trim();
  if(!text){ alert('請寫下祝福內容唷～'); return; }

  // 先 ping 後端
  try{
    const ping = await fetch(WEBHOOK+'?action=ping',{method:'GET',cache:'no-store'});
    const t = await ping.text().catch(()=> ''); if(String(t).trim().toLowerCase()!=='ok'){
      setStatus('⚠️ 後端未回應正常（ping='+t+'），請檢查 GAS 部署'); return;
    }
  }catch(_){ setStatus('⚠️ 無法連到後端（ping 失敗）'); return; }

  setStatus('⏳ 送出中…');

  const payload = {
    action: 'createBlessing',
    lineId, displayName, pictureUrl,
    contentHTML: text,
    signaturePNG: signatureDataURL || '',
    extra: {}
  };

  const ctl=new AbortController(); const timer=setTimeout(()=>ctl.abort(), TIMEOUT_MS);
  try{
    const r = await fetch(WEBHOOK,{ method:'POST', headers:{'Content-Type':'text/plain;charset=UTF-8'}, body: JSON.stringify(payload), signal: ctl.signal, keepalive:true });
    clearTimeout(timer);
    const ct=(r.headers.get('content-type')||'').toLowerCase();
    let j=null;
    if(ct.includes('application/json')) j=await r.json().catch(()=>null);
    else { const t=await r.text().catch(()=> ''); if(/^\s*\{/.test(t)) try{ j=JSON.parse(t); }catch(_){} }
    if(!j && r.ok) j={ok:true};

    if(j && j.ok){
      setStatus('✅ 祝福已送出成功！');
      // 如需鎖定，可開啟：
      // editor.setAttribute('contenteditable','false');
      // document.getElementById('btnSubmit').disabled = true;
    }else{
      setStatus('❌ 送出失敗，請稍後再試');
    }
  }catch(e){
    setStatus('❌ 送出逾時或失敗：'+ (e?.message||''));
  }
});

/* ====================== 啟動 ====================== */
window.addEventListener('DOMContentLoaded', ()=>{
  // 初始狀態列文案
  setStatus('等待初始化…');
  // 顯示 placeholder
  showPlaceholder();
  // 沒載入 LIFF SDK 也能先看畫面
  if(window.liff) initLIFF(); else setStatus('就緒（未啟動 LIFF）');
});
</script>

<!-- 可選：若要直接在 LIFF 內運行，記得引入 LIFF SDK；先註解起來，需用時打開 -->
<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
</body>
</html>
